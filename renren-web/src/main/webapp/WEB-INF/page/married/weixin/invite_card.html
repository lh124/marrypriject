<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>“码”上结婚</title>
    <link rel="stylesheet" href="${rc.contextPath}/statics/marry/css/weui.min.css"/>
    <link rel="stylesheet" href="${rc.contextPath}/statics/marry/css/marry.css"/>
    <script type="text/javascript" src="${rc.contextPath}/statics/marry/js/reset.js"></script>
    <script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>   
    <script src="https://res.wx.qq.com/open/libs/weuijs/1.0.0/weui.min.js"></script> 
</head>
<script type="text/javascript">
    $(function() {
	    $.ajax({
			type: "POST",
		    url: "../weixin/me/findWedding?id="+$("#weddingId").val(),
			dataType: "json",
			success: function(result){
			     if(result.status == 'ok'){
			          if(result.data.marryWedding != null){
				          $("#groomNameandbrideName").html(result.data.marryWedding.groomname+"&"+result.data.marryWedding.bridename);
				          $("#weddingDate").html(result.data.marryWedding.weddingdate);
				          $("#weddingAddress").html("地址："+result.data.marryWedding.weddingaddress);
				          $("#content").html(result.data.marryWedding.content);
				          $('#photo').prop('src',result.data.marryWedding.photo);
			          }
			     }
			}
	 	});
 	});
 	
 	function GetQueryString(name){
		     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
		     var r = window.location.search.substr(1).match(reg);
		     if(r!=null)return  unescape(r[2]); return null;
		}
 	
 	function update(states){
 	      var id = $("#weddingId").val();
 	      var code = GetQueryString("code");
 	      $.ajax({
				type: "POST",
			    url: "../weixin/me/attendawedding?states="+states+"&id="+id+"&code="+code,
				dataType: "json",
				success: function(result){
				     if(result.status == 'ok'){
				          window.location.href="send_bless.html?weddingId="+id; 
				     }
				}
		 	});
 	}
</script>
<body ontouchstart style="background:#ffffff;">
    <input type="hidden" id="weddingId" value="${request.getParameter('id')}">
	<div class="container" id="container" >
		<div class="page" id="pageContainer">
			<div class="invite_con">
				<div style="padding-top:2.3rem;">
					<img src="" id="photo"/>
				</div>
				<h3 id="groomNameandbrideName"></h3>
				<h4 id="weddingDate"></h4>
				<p id="content"></p>
				<p class="address" id="weddingAddress"></p>
			</div>
			<div class="invite_sure weui-flex">
				<div class="weui-flex__item">
					<a href="#" onclick="update(0)">暂定</a>
				</div>
				<div class="weui-flex__item">
					<a class="act" href="#" onclick="update(1)">接受</a>
				</div>
				<div class="weui-flex__item">
					<a href="#" onclick="update(2)">无法参加</a>
				</div>
	        </div>
		</div>
	</div>
</body>
</html>