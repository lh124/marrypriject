<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>“码”上结婚</title>
    <link rel="stylesheet" href="${rc.contextPath}/statics/marry/css/weui.min.css"/>
	<link rel="stylesheet" href="${fieldTool.STATIC_SOURCE_CSS}weui2.css"/>
	<link rel="stylesheet" href="${fieldTool.STATIC_SOURCE_CSS}weui3.css"/>
	<link rel="stylesheet" href="${fieldTool.STATIC_SOURCE_CSS}video.css">
    <link rel="stylesheet" href="${rc.contextPath}/statics/marry/css/marry.css"/>
    <script type="text/javascript" src="${rc.contextPath}/statics/marry/js/reset.js"></script>
    <link rel="stylesheet" href="${rc.contextPath}/statics/marry/css/bootstrap.min.css"/>
    <script type="text/javascript" src="${rc.contextPath}/statics/marry/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="${rc.contextPath}/statics/marry/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="${rc.contextPath}/statics/marry/css/banner.css"/>
    <script type="text/javascript" src="${rc.contextPath}/statics/marry/js/banner.js"></script>
    <script type="text/javascript" src="${fieldTool.STATIC_SOURCE_CSS}video.js"></script>
  	<script src="${rc.contextPath}/statics/jstx/amazeui.min.js"></script>
</head>
<body ontouchstart style="background:white;" >
	<div class="container" id="container" style="padding:0;">
		<div class="page interact" id="pageContainer">
			<div class="interact_top" style="margin:0;z-index:222;">
				<div id="carousel-example-generic" class="carousel slide" data-ride="carousel" style="height:5.3rem;">
				  <!-- Wrapper for slides -->
				  <div class="carousel-inner" role="listbox" style="height:5.3rem;">
				    <div class="item active" style="height:5.3rem;">
				      <img src="${rc.contextPath}/statics/marry/img/in1.png" alt="...">
				    </div>
				    <div class="item" style="height:5.3rem;">
				      <img src="${rc.contextPath}/statics/marry/img/in2.png" alt="...">
				    </div>
				    <div class="item" style="height:5.3rem;">
				      <img src="${rc.contextPath}/statics/marry/img/in3.png" alt="...">
				    </div>
				    <div class="item" style="height:5.3rem;">
				      <img src="${rc.contextPath}/statics/marry/img/in4.png" alt="...">
				    </div>   
				  </div>
				</div>
			</div>
			<video  id="theVedio" class="interact_top" style="margin:0;z-index:224;display:none;"controls="controls" >  
	            你的浏览器不支持HTML5播放此视频  
				<span style="white-space:pre">    </span><!-- 支持播放的文件格式 -->  
			    <source id="aa" src="http://www.w3school.com.cn/example/html5/mov_bbb.mp4" type='video/mp4' />   
			</video>
			<div class="banner interact_top" id="banner1" style="margin:0;z-index:222;display:none;">
				<div class="banner-view"></div>
				<div class="banner-btn" style="visibility:hidden;"></div>
				<div class="banner-number"></div>
				<div class="banner-progres"></div>
			</div>
			<div class="page__bd">
		        <div class="weui-tab">
		            <div class="weui-tab__panel screen_mid" style="margin-top:5.3rem;">
		           		<div class="screen_mid_top"></div>
							<div class="screen_con">
								<a href="./send_money.html">
									<dl title="1">
										<dt>
											<img src="${rc.contextPath}/statics/marry/img/screen6.png">
										</dt>
										<dd>红包雨</dd>
										<span>进行中</span>
									</dl>
								</a>
								<dl title="2" class="video">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen2.png">
									</dt>
									<dd>视频</dd>
									<span>进行中</span>
								</dl>
								<dl title="3" class="photo">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen3.png">
									</dt>
									<dd>摄影展</dd>
									<span>进行中</span>
								</dl>
								<dl title="4" style="display:none;">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen1.png">
									</dt>
									<dd>祝福</dd>
									<span >进行中</span>
								</dl>
								<dl title="5" style="display:none;">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen4.png">
									</dt>
									<dd>抢红包</dd>
									<span>进行中</span>
								</dl>
								<dl title="6" style="display:none;">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen5.png">
									</dt>
									<dd>相册</dd>
									<span>进行中</span>
								</dl>
								<dl title="7" style="display:none;">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen7.png">
									</dt>
									<dd>摇一摇</dd>
									<span>进行中</span>
								</dl>
								<dl title="8" style="display:none;">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen8.png">
									</dt>
									<dd>抽奖</dd>
									<span>进行中</span>
								</dl>
								<dl title="9" style="display:none;">
									<dt>
										<img src="${rc.contextPath}/statics/marry/img/screen9.png">
									</dt>
									<dd>小游戏</dd>
									<span>进行中</span>
								</dl>
							</div>
							<div class="screen_mid_bot"></div>
		            </div>
		        </div>
		    </div>
		</div>
	</div>
	<script type="text/javascript">
	    var imgs=[];
	    var video=[];
		/*摄影展示*/
		function sheying(){
			var a = document.documentElement.clientWidth;
			var b = a*1075/1920;
			var banner = new FragmentBanner({
				container : "#banner1",//选择容器 必选
				imgs : imgs,//图片集合 必选
				size : {
					width : a,
					height : b
				},//容器的大小 可选
				//行数与列数 可选
				grid : {
					line : 12,
					list : 14
				},
				index: 0,//图片集合的索引位置 可选
				type : 1,//切换类型 1 ， 2 可选
				boxTime : 5000,//小方块来回运动的时长 可选
				fnTime : 10000//banner切换的时长 可选
			});
		};
		$(function(){
			 var websocket = null;
		     //判断当前浏览器是否支持WebSocket
		     if ('WebSocket' in window) {
		         websocket = new WebSocket("ws://192.168.1.107:8080/wrs/smart/websocket");
		     }
		     else {
		         alert('当前浏览器 Not support websocket')
		     }
			$(".screen_con dl").on("click",function(){
				$(".screen_con dl").find('span').hide();
				var id = $(this).attr("title");
				var obj = JSON.stringify({
		    		id:id
		    	});
				websocket.send(obj);
				$(this).find("span").show();
				$(".banner-number").html("");
			});
			$('.carousel').carousel();
			$(".photo").on("click",function(){
				$(".interact_top").hide();
				sheying();
				$("#banner1").show();
			});
			$(".video").on("click",function(){
			    if(video.length >0){
				    $("#theVedio").attr("src",video[0]);
				}
				$(".interact_top").hide();
				$("#theVedio").show();
				$(".banner-number").html("");
				//视频样式设置
				video1.play();
			});
			
			var vList = video; // 初始化播放列表    
	        var vLen = vList.length;   
	        var curr = 0;   
	        var video1 = document.getElementById("theVedio");    
	        video1.addEventListener('ended', function(){  
	            play();  
	        });    
	           
	        function play() {    
	            video1.src = vList[curr];    
	            video1.load();     
	            video1.play();    
	            curr++;    
	            if(curr >= vLen){    
	                curr = 0; //重新循环播放  
	            }    
	            
	        }    
			
			$.ajax({
				type: "POST",
			    url: "../weixin/me/findAllWeddingPhoto",
			    dataType: "json",
			    success: function(result){
			        if(result.status == 'ok'){
			             for(var i = 0; i < result.list.length; i++){
			                 if(result.list[i].type=='1'){
			                     imgs.push(result.list[i].pic);
			                 }else{
			                     video.push(result.list[i].pic);
			                 }
			             }
			        }
				}
			});
		});
	</script>
</body>
</html>